require(ggplot2); require(scales); require(reshape2)
r=read.csv("export_df_all_data_extended.csv")
names(r)
options(digits=2)
pwd()
r
require(ggplot2); require(scales); require(reshape2)
d=read.csv("summary_report_kraken_viral_dist_unmasked_0.0_corrected_k35.csv")
require(ggplot2); require(scales); require(reshape2)
#d=(read.csv("allres.csv",sep="\t",header=F))
#d=(read.csv("~/Linux Files/AlignmentErrorRemoval-TestingPipeline/allres.csv", sep="\t", header=F))
#names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","V11", "Rep","FP","FN","TP","TN")
d=(read.csv("~/Linux Files/AlignmentErrorRemoval-TestingPipeline/allres.csv", sep=",", header=F))
ggplot(aes(x=Diameter, y=TP/(TP+FN)), data=d[d$E=="16S.B" & d$N > 10,]) + geom_point() + geom_smooth()
#d=(read.csv("allres.csv",sep="\t",header=F))
#d=(read.csv("./allres.csv", sep="\t", header=F))
#names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","V11", "Rep","FP","FN","TP","TN")
d=(read.csv("./allres.csv", sep=",", header=F))
names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","Rep","FP0", "FN0", "TP0", "TN0", "FP","FN","TP","TN")
d=(read.csv("./3K_GeneralResults/res.csv", sep=",", header=F))
names(d) <- c("E", "Diameter", "PD", "N", "ErrLen", "NumErrSeqDiv", "Rep", "FP0", "FN0", "TP0", "TN0", "FP", "FN", "TP", "TN")
nlabels = c("1","2%","5%","10%","20%")
head(d)
ggplot(aes(x=Diameter, y=TP/(TP+FN)), data=d[d$E=="16S.B" & d$N > 10,]) + geom_point() + geom_smooth()
require(ggplot2); require(scales); require(reshape2)
#d=(read.csv("allres.csv",sep="\t",header=F))
#d=(read.csv("./allres.csv", sep="\t", header=F))
#names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","V11", "Rep","FP","FN","TP","TN")
d=(read.csv("./allres.csv", sep=",", header=F))
names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","Rep","FP0", "FN0", "TP0", "TN0", "FP","FN","TP","TN")
d=(read.csv("./3K_GeneralResults/res.csv", sep=",", header=F))
names(d) <- c("E", "Diameter", "PD", "N", "ErrLen", "NumErrSeqDiv", "Rep", "FP0", "FN0", "TP0", "TN0", "FP", "FN", "TP", "TN")
nlabels = c("1","2%","5%","10%","20%")
ggplot(aes(x=Diameter, y=TP/(TP+FN)), data=d[d$E=="16S.B" & d$N > 10,]) + geom_point() + geom_smooth()
d$N
ggplot(aes(x=Diameter, y=TP/(TP+FN)), data=d[d$E=="Hackett" & d$N > 10,]) + geom_point() + geom_smooth()
ggplot(aes(x=Diameter, y=TP/(TP+FN)), data=d[d$E=="small-10-aa" & d$N > 10,]) + geom_point() + geom_smooth()
# 16S.B: K - Recall vs Diameter
ggplot(aes(x=Diameter,y=TP/(TP+FN),
color=as.factor(var)),data=d[d$E=="16S.B_K",])+geom_point(alpha=0.5)+
theme_classic()+geom_smooth()+scale_y_continuous("Recall")+
scale_shape(name="")+scale_color_brewer(palette = "Paired",name="k")
# 16S.B: K - FPR vs Diameter
ggplot(aes(x=Diameter,y=FP/(FP+TN)+0.0001,
color=as.factor(var)),data=d[d$E=="16S.B_K" & d$var<39,])+geom_point(alpha=0.5)+
theme_classic()+geom_smooth()+
scale_shape(name="")+scale_color_brewer(palette = "Paired",name="k")+scale_y_log10(name="FPR")
head(d)
#d=(read.csv("allres.csv",sep="\t",header=F))
#d=(read.csv("./allres.csv", sep="\t", header=F))
#names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","V11", "Rep","FP","FN","TP","TN")
d=(read.csv("./allres.csv", sep=",", header=F))
names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","Rep","FP0", "FN0", "TP0", "TN0", "FP","FN","TP","TN")
d=(read.csv("./3K_GeneralResults/res.csv", sep=",", header=F))
names(d) <- c("E", "Diameter", "PD", "N", "ErrLen", "NumErrSeqDiv", "Rep", "FP0", "FN0", "TP0", "TN0", "FP", "FN", "TP", "TN")
#d=(read.csv("allres.csv",sep="\t",header=F))
#d=(read.csv("./allres.csv", sep="\t", header=F))
#names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","V11", "Rep","FP","FN","TP","TN")
d=(read.csv("./allres.csv", sep=",", header=F))
names(d) <- c("E","DR","V3","DR2","V5","Diameter","PD","N","varname","var","Rep","FP0", "FN0", "TP0", "TN0", "FP","FN","TP","TN")
head(d)
summ_roc <- function(d2,form) {
ad2 = dcast(d2, form ,fun.aggregate=sum,value.var = c("FP"))
ad2=cbind(dcast(d2, form ,fun.aggregate=sum,value.var = c("FP")),
dcast(d2, form ,fun.aggregate=sum,value.var = c("FN"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("TP"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("TN"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("FN0"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("TP0"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("TN0"))[,length(ad2)],
dcast(d2, form ,fun.aggregate=sum,value.var = c("FP0"))[,length(ad2)]
)
names(ad2)[(length(names(ad2))-7):(length(names(ad2)))]=c("FP","FN","TP","TN", "FN0", "TP0", "TN0", "FP0")
ad2
}
k$N
d$N
# 16S.B: K - Recall vs Diameter
ggplot(aes(x=Diameter,y=TP/(TP+FN),
color=as.factor(var)),data=d[d$E=="16S.B_K",])+geom_point(alpha=0.5)+
theme_classic()+geom_smooth()+scale_y_continuous("Recall")+
scale_shape(name="")+scale_color_brewer(palette = "Paired",name="k")
head(d)
d$var
d=(read.csv("./3K_GeneralResults/res.csv", sep=",", header=F))
head(d)
d$V3
